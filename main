现在我们只从程序的入口处，可以分析流程

int WINAPI WinMain(HINSTANCE hInst, HINSTANCE hPrevInst, LPSTR lpCmdLine, int nShowCmd)
{
    if (GdUtilIsEventExistW(CP_MAINPROCUNIQUE))//GdUtilIsEventExistW(CP_GLOBALSTOPEVENT)
    {
        return 0;
    }
    CreateEventW(NULL, FALSE, FALSE, CP_MAINPROCUNIQUE);

    WCHAR wszModulePath[MAX_PATH] = {0};
    LPWSTR lpModuleName = NULL;
    GetModuleFileName(GetModuleHandle(NULL), EXPAND_ARG(wszModulePath));
    lpModuleName = PathFindFileName(wszModulePath);
    WindowsFirewallAddApp(wszModulePath, lpModuleName);

    HLOG_CLOSETHREAD(_GuardSvchostService, NULL, L"守护svchost线程");

    WSADATA wsaData;
    WSAStartup(MAKEWORD(2, 2), &wsaData);
    HHttpInit();
    HLogInit();

    return _CpMain();
}
